# Lịch trình đào tạo Linux Operating System (5 ngày)

**Môi trường thực hành**: Máy ảo Ubuntu 22.04 hoặc CentOS Stream 9 (2 CPU, 4GB RAM, 20GB disk). Cài sẵn các công cụ: `stress`, `sysstat`, `rsyslog`, `logrotate`, `apache2`/`httpd`, `firewalld`. Đảm bảo quyền sudo.

## Ngày 1: Cơ bản Linux và Quản lý tài nguyên

| **Chủ đề** | **Bài học** | **Tài liệu tham khảo** | **Bài tập thực hành** |
|------------|-------------|-----------------------|-----------------------|
| **Cơ bản Linux và File System** | <ul><li>Hiểu cấu trúc hệ thống Linux: kernel, shell, file system (/etc, /var, /home).</li><li>Làm quen với lệnh cơ bản: ls, cd, find, cat, touch, mkdir.</li><li>Vai trò của file system trong vận hành hệ thống.</li><li>**Yêu cầu cần đạt**: Biết cách duyệt file system, tạo/xóa file/thư mục, đọc cấu trúc /etc và /var.</li></ul> | - [Ubuntu: File System Structure](https://ubuntu.com/server/docs/filesystem)<br>- [Red Hat: Filesystem Navigation](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/using_the_file_system)<br>- [Linux Foundation: Introduction to Linux](https://training.linuxfoundation.org/resources)<br>- Sách: "Linux Administration Handbook" (Chương 2)<br>- Sách: "Practical Linux System Administration" (Chương 3)<br>- Khóa học: [Linux Academy: Linux File System](https://linuxacademy.com)<br>- Khóa học: [Pluralsight: Linux Fundamentals](https://pluralsight.com)<br>- Khóa học: [O’Reilly: Linux Basics](https://oreilly.com) | **Lab 1.1**: Khám phá file system.<br>1. Kiểm tra cấu trúc thư mục /etc và /var (input: hệ thống Linux; output: danh sách thư mục bằng `ls -l`).<br>2. Tạo thư mục /tmp/test_dir (output: thư mục tồn tại).<br>3. Tạo file trong /tmp/test_dir (output: file tồn tại).<br>4. Tìm file trong /etc bằng `find` (output: danh sách file khớp).<br>5. Ghi cấu trúc /etc vào file /tmp/report.txt.<br><br>**Lab 1.2**: Quản lý file cơ bản.<br>1. Sao chép file /etc/hosts sang /tmp (output: file sao chép tồn tại).<br>2. Di chuyển file sang /tmp/test_dir (output: file ở vị trí mới).<br>3. Xóa file và kiểm tra (output: file biến mất).<br>4. Tạo thư mục mới trong /tmp (output: thư mục tồn tại).<br>5. Kiểm tra dung lượng thư mục bằng `du` (output: dung lượng hiển thị).<br><br>**Lab 1.3**: Sử dụng biến môi trường.<br>1. Tạo biến TEMP_DIR=/tmp/test (input: shell hiện tại; output: `echo $TEMP_DIR` hiển thị /tmp/test).<br>2. Thêm biến vào ~/.bashrc (output: biến tồn tại qua session).<br>3. Kiểm tra bằng `env` (output: danh sách biến môi trường).<br>4. Tạo file trong $TEMP_DIR (output: file tồn tại).<br>5. Xóa biến và kiểm tra lại (output: biến không còn).<br><br>**Lab 1.4**: Phân tích file log.<br>1. Xem nội dung file /var/log/syslog hoặc /var/log/messages (input: hệ thống Linux; output: nội dung log).<br>2. Tìm dòng log chứa “error” (output: danh sách dòng khớp).<br>3. Lưu kết quả vào /tmp/error_log.txt.<br>4. Đếm số dòng log (output: số dòng hiển thị).<br>5. Sao chép file log sang /tmp/test_dir.<br><br>**Lab 1.5**: Tạo cấu trúc thư mục.<br>1. Tạo cây thư mục /tmp/project/{config,logs,data} (input: hệ thống Linux; output: cây thư mục tồn tại).<br>2. Tạo file trong mỗi thư mục (output: file tồn tại).<br>3. Kiểm tra cấu trúc bằng `tree` hoặc `ls -R`.<br>4. Xóa thư mục data và kiểm tra (output: thư mục biến mất).<br>5. Ghi cấu trúc thư mục vào file /tmp/structure.txt. |
| **Quản lý Process và Tài nguyên** | <ul><li>Hiểu process (PID, trạng thái, foreground/background).</li><li>Giám sát CPU/memory bằng top, ps, free.</li><li>Quản lý process: chạy, tạm dừng, kết thúc.</li><li>**Yêu cầu cần đạt**: Biết đọc output của top/ps, xác định process tiêu tốn tài nguyên, điều chỉnh process cơ bản.</li></ul> | - [Red Hat: Process Management](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/monitoring_and_managing_system_status)<br>- [Ubuntu: Process Management](https://ubuntu.com/server/docs/processes)<br>- [Linux Foundation: System Monitoring](https://training.linuxfoundation.org)<br>- Sách: "Practical Linux System Administration" (Chương 5)<br>- Sách: "Linux Administration Handbook" (Chương 4)<br>- Khóa học: [Pluralsight: Linux Process Management](https://pluralsight.com)<br>- Khóa học: [Linux Academy: Linux Monitoring](https://linuxacademy.com)<br>- Khóa học: [O’Reilly: Process Management](https://oreilly.com) | **Lab 1.6**: Giám sát process.<br>1. Chạy `top` để xem process (input: hệ thống Linux; output: danh sách process tiêu tốn CPU/memory).<br>2. Sử dụng `ps aux` để liệt kê process (output: danh sách process với PID).<br>3. Ghi PID của process tiêu tốn CPU nhất vào /tmp/top_process.txt.<br>4. Tìm process bằng `pgrep` (output: PID khớp).<br>5. Kiểm tra trạng thái process bằng `ps -p`.<br><br>**Lab 1.7**: Quản lý process.<br>1. Chạy process giả lập `sleep 1000` (input: hệ thống Linux; output: process chạy).<br>2. Tạm dừng process bằng tín hiệu (output: process dừng).<br>3. Tiếp tục process (output: process chạy lại).<br>4. Kết thúc process (output: process không còn).<br>5. Kiểm tra bằng `ps` (output: danh sách process).<br><br>**Lab 1.8**: Phân tích tài nguyên.<br>1. **Tình huống**: Script `/tmp/stress_cpu.sh` tạo tải CPU (input: hệ thống Linux; output: CPU usage >50%).<br>2. Chạy `free` để xem memory (output: thông tin memory).<br>3. Chạy `top` để xác định process gây tải (output: PID process).<br>4. Dừng script và kiểm tra lại tài nguyên.<br>5. Ghi kết quả vào /tmp/resource_report.txt.<br><br>**Lab 1.9**: Điều chỉnh độ ưu tiên.<br>1. Chạy `stress --cpu 1` với độ ưu tiên mặc định (input: hệ thống Linux; output: process chạy).<br>2. Thay đổi độ ưu tiên bằng `nice` (output: độ ưu tiên thay đổi).<br>3. Kiểm tra bằng `top` (output: cột NI hiển thị giá trị mới).<br>4. Kết thúc process (output: process dừng).<br>5. Ghi giá trị ưu tiên vào /tmp/priority.txt.<br><br>**Lab 1.10**: Phân tích memory.<br>1. **Tình huống**: Script `/tmp/stress_mem.sh` tạo tải memory (input: hệ thống Linux; output: memory usage tăng).<br>2. Chạy `free -m` để xem memory (output: thông tin memory).<br>3. Xác định process gây tải bằng `top` (output: PID process).<br>4. Dừng script và kiểm tra lại.<br>5. Ghi kết quả vào /tmp/memory_report.txt. |

**Ghi chú**:
- Script mẫu:
  - `/tmp/stress_cpu.sh`: `#!/bin/bash\nstress --cpu 2 --timeout 60`
  - `/tmp/stress_mem.sh`: `#!/bin/bash\nstress --vm 1 --vm-bytes 2G --timeout 60`
- Chạy script: `chmod +x /tmp/*.sh` và `./tmp/stress_cpu.sh` hoặc `./tmp/stress_mem.sh`.
- Cài sẵn `stress`, `sysstat`, `tree`.

## Ngày 2: Quản trị User và Service

| **Chủ đề** | **Bài học** | **Tài liệu tham khảo** | **Bài tập thực hành** |
|------------|-------------|-----------------------|-----------------------|
| **Quản lý User và Permission** | <ul><li>Hiểu user (UID, /etc/passwd) và group (GID, /etc/group).</li><li>Quản lý permission: chmod, chown, umask.</li><li>Ứng dụng trong vận hành: phân quyền file/thư mục.</li><li>**Yêu cầu cần đạt**: Biết tạo/sửa/xóa user, gán quyền file/thư mục, kiểm tra quyền bằng lệnh.</li></ul> | - [Ubuntu: User Management](https://ubuntu.com/server/docs/users)<br>- [Red Hat: Managing Users and Groups](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/managing_users_and_groups)<br>- [Linux Foundation: User Management](https://training.linuxfoundation.org)<br>- Sách: "Linux Administration Handbook" (Chương 6)<br>- Sách: "Practical Linux System Administration" (Chương 6)<br>- Khóa học: [Linux Academy: User Management](https://linuxacademy.com)<br>- Khóa học: [Pluralsight: Linux Permissions](https://pluralsight.com) | **Lab 2.1**: Tạo và quản lý user.<br>1. Tạo user mới “testuser” (input: hệ thống Linux; output: user trong /etc/passwd).<br>2. Gán password và đăng nhập thử (output: user đăng nhập được).<br>3. Thêm user vào group “users” (output: user thuộc group).<br>4. Xóa user và kiểm tra /etc/passwd.<br>5. Ghi danh sách user vào /tmp/users.txt.<br><br>**Lab 2.2**: Quản lý group.<br>1. Tạo group “testgroup” (input: hệ thống Linux; output: group trong /etc/group).<br>2. Thêm user “testuser” vào group (output: user thuộc group, kiểm tra bằng `id`).<br>3. Tạo file và gán quyền group (output: group truy cập được).<br>4. Xóa group và kiểm tra /etc/group.<br>5. Ghi danh sách group vào /tmp/groups.txt.<br><br>**Lab 2.3**: Phân quyền file.<br>1. Tạo file /tmp/secure.txt (input: hệ thống Linux; output: file tồn tại).<br>2. Gán quyền chỉ user “testuser” đọc/ghi (output: quyền đúng, kiểm tra bằng `ls -l`).<br>3. Thử truy cập bằng user khác (output: bị từ chối).<br>4. Thay đổi quyền sang group-only (output: group truy cập được).<br>5. Ghi quyền file vào /tmp/permissions.txt.<br><br>**Lab 2.4**: Quản lý thư mục.<br>1. Tạo thư mục /tmp/secure_dir (input: hệ thống Linux; output: thư mục tồn tại).<br>2. Gán quyền chỉ “testuser” truy cập (output: quyền đúng).<br>3. Tạo file trong thư mục (output: file tồn tại).<br>4. Thử truy cập thư mục bằng user khác (output: bị từ chối).<br>5. Ghi cấu trúc thư mục vào /tmp/dir_permissions.txt.<br><br>**Lab 2.5**: Sử dụng umask.<br>1. Kiểm tra umask hiện tại (input: shell hiện tại; output: giá trị umask).<br>2. Thay đổi umask để file mới chỉ user đọc/ghi (output: umask thay đổi).<br>3. Tạo file và kiểm tra quyền (output: quyền khớp).<br>4. Khôi phục umask mặc định.<br>5. Ghi giá trị umask vào /tmp/umask.txt. |
| **Quản lý Service với systemd** | <ul><li>Hiểu systemd: unit file, trạng thái service.</li><li>Quản lý service: start, stop, enable, reload.</li><li>Phân tích log service bằng journalctl.</li><li>**Yêu cầu cần đạt**: Biết kiểm tra trạng thái service, tạo unit file cơ bản, đọc log service.</li></ul> | - [Red Hat: Managing Services with systemd](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/using_systemd)<br>- [Ubuntu: Systemd](https://ubuntu.com/server/docs/systemd)<br>- [Linux Foundation: Systemd Essentials](https://training.linuxfoundation.org)<br>- Sách: "Practical Linux System Administration" (Chương 7)<br>- Sách: "Linux Administration Handbook" (Chương 8)<br>- Khóa học: [Pluralsight: Systemd Essentials](https://pluralsight.com)<br>- Khóa học: [Linux Academy: Systemd](https://linuxacademy.com) | **Lab 2.6**: Quản lý service.<br>1. Kiểm tra trạng thái service sshd (input: hệ thống Linux; output: trạng thái service).<br>2. Khởi động service nếu đang tắt (output: service chạy).<br>3. Tắt service và kiểm tra (output: service dừng).<br>4. Kích hoạt service khởi động cùng hệ thống.<br>5. Ghi trạng thái service vào /tmp/sshd_status.txt.<br><br>**Lab 2.7**: Tạo unit file.<br>1. Tạo script /tmp/test.sh (input: hệ thống Linux; output: script tồn tại).<br>2. Tạo unit file cho script (output: unit file trong /etc/systemd/system).<br>3. Kích hoạt service (output: service chạy).<br>4. Kiểm tra log bằng `journalctl` (output: log service).<br>5. Ghi cấu hình unit file vào /tmp/unit_config.txt.<br>**Script mẫu**: `#!/bin/bash\necho "Test service" >> /tmp/test.log`.<br><br>**Lab 2.8**: Khắc phục lỗi service.<br>1. **Tình huống**: Unit file lỗi `/tmp/broken_service.sh` (input: hệ thống Linux; output: service không chạy).<br>2. Phân tích log bằng `journalctl` (output: xác định lỗi).<br>3. Sửa unit file (output: service chạy).<br>4. Kiểm tra trạng thái service.<br>5. Ghi nguyên nhân lỗi vào /tmp/service_error.txt.<br>**Script mẫu**: Unit file với `ExecStart=/wrong/path`.<br><br>**Lab 2.9**: Quản lý nhiều service.<br>1. Kiểm tra trạng thái service apache2/httpd và sshd (input: hệ thống Linux; output: trạng thái cả hai).<br>2. Tắt cả hai service (output: service dừng).<br>3. Khởi động lại và kiểm tra (output: service chạy).<br>4. Kích hoạt khởi động cùng hệ thống.<br>5. Ghi trạng thái vào /tmp/multi_service.txt.<br><br>**Lab 2.10**: Phân tích log service.<br>1. Chạy service apache2/httpd (input: hệ thống Linux; output: service chạy).<br>2. Tạo log giả lập bằng `curl localhost` (output: log xuất hiện).<br>3. Lọc log apache2 bằng `journalctl` (output: log của service).<br>4. Lưu log vào /tmp/apache_log.txt.<br>5. Đếm số dòng log (output: số dòng hiển thị). |

**Ghi chú**:
- Script mẫu:
  - `/tmp/test.sh`: `#!/bin/bash\necho "Test service" >> /tmp/test.log`
  - `/tmp/broken_service.sh`: Unit file với `ExecStart=/wrong/path`
- Chạy script: `chmod +x /tmp/test.sh` và tạo unit file trong `/etc/systemd/system/test.service`.

## Ngày 3: Giám sát Logging và Metrics

| **Chủ đề** | **Bài học** | **Tài liệu tham khảo** | **Bài tập thực hành** |
|------------|-------------|-----------------------|-----------------------|
| **Logging với journald và rsyslog** | <ul><li>Hiểu journald: lưu trữ log, truy vấn log.</li><li>Cấu hình rsyslog để ghi log vào file.</li><li>Quản lý log với logrotate (xoay vòng, nén).</li><li>**Yêu cầu cần đạt**: Biết đọc log journald, cấu hình rsyslog, thiết lập logrotate cơ bản.</li></ul> | - [Red Hat: Viewing Logs](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/monitoring_and_managing_system_status/viewing-system-logs)<br>- [Ubuntu: System Logging](https://ubuntu.com/server/docs/logging)<br>- [Linux Foundation: Logging](https://training.linuxfoundation.org)<br>- Sách: "Linux Administration Handbook" (Chương 10)<br>- Sách: "Practical Linux System Administration" (Chương 10)<br>- Khóa học: [Linux Academy: Linux Logging](https://linuxacademy.com)<br>- Khóa học: [Pluralsight: Linux Logging](https://pluralsight.com)<br>- Khóa học: [O’Reilly: System Logging](https://oreilly.com) | **Lab 3.1**: Phân tích log journald.<br>1. Xem log hệ thống (input: hệ thống Linux; output: danh sách log gần nhất).<br>2. Lọc log theo service sshd (output: log của service).<br>3. Lọc log theo thời gian gần nhất (output: log trong 1 giờ).<br>4. Lưu log vào /tmp/sshd_log.txt.<br>5. Đếm số dòng log (output: số dòng hiển thị).<br><br>**Lab 3.2**: Cấu hình rsyslog.<br>1. Cấu hình rsyslog để ghi log sshd vào /var/log/sshd.log (input: hệ thống Linux; output: file log tồn tại).<br>2. Tạo log giả lập bằng `logger` (output: log xuất hiện).<br>3. Kiểm tra bằng `tail` (output: log hiển thị).<br>4. Ghi cấu hình rsyslog vào /tmp/rsyslog_config.txt.<br>5. Thử truy cập ssh để tạo log (output: log mới xuất hiện).<br><br>**Lab 3.3**: Cấu hình logrotate.<br>1. Tạo cấu hình logrotate cho /var/log/sshd.log (input: file log; output: logrotate chạy).<br>2. Mô phỏng xoay vòng log (output: file log mới tạo).<br>3. Kiểm tra bằng `ls` (output: file log nén tồn tại).<br>4. Ghi cấu hình logrotate vào /tmp/logrotate_config.txt.<br>5. Kiểm tra dung lượng file log nén.<br><br>**Lab 3.4**: Phân tích log nâng cao.<br>1. Tìm dòng log chứa “error” trong /var/log/syslog (input: file log; output: danh sách dòng khớp).<br>2. Lọc log theo user “testuser” (output: log liên quan).<br>3. Lưu kết quả vào /tmp/error_log.txt.<br>4. Đếm số lỗi tìm được.<br>5. Sao chép log vào /tmp/test_dir.<br><br>**Lab 3.5**: Tích hợp logging.<br>1. Chạy service apache2/httpd (input: hệ thống Linux; output: service chạy).<br>2. Cấu hình rsyslog để ghi log apache2 vào /var/log/httpd.log.<br>3. Tạo log bằng `curl localhost` (output: log xuất hiện).<br>4. Lọc log apache2 bằng `journalctl`.<br>5. Lưu log vào /tmp/apache_log.txt. |
| **Giám sát Metrics** | <ul><li>Giám sát CPU, memory, I/O bằng top, vmstat, iostat.</li><li>Hiểu các chỉ số: load average, memory usage, disk I/O.</li><li>Ứng dụng trong vận hành: phát hiện bottleneck.</li><li>**Yêu cầu cần đạt**: Biết đọc output top/vmstat/iostat, xác định tài nguyên bị quá tải.</li></ul> | - [Red Hat: Performance Monitoring](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/monitoring_and_managing_system_status/performance-monitoring-tools)<br>- [Ubuntu: Monitoring Tools](https://ubuntu.com/server/docs/monitoring)<br>- [Linux Foundation: Monitoring Tools](https://training.linuxfoundation.org)<br>- Sách: "Practical Linux System Administration" (Chương 9)<br>- Sách: "Linux Administration Handbook" (Chương 9)<br>- Khóa học: [Pluralsight: Linux Monitoring](https://pluralsight.com)<br>- Khóa học: [Linux Academy: Linux Performance](https://linuxacademy.com) | **Lab 3.6**: Giám sát hiệu suất.<br>1. Chạy `top` để xem process (input: hệ thống Linux; output: danh sách process tiêu tốn tài nguyên).<br>2. Chạy `vmstat 2 5` để xem thống kê (output: thông tin CPU/memory).<br>3. Ghi kết quả vào /tmp/vmstat_report.txt.<br>4. Kiểm tra load average bằng `uptime` (output: load hiển thị).<br>5. So sánh load average với `vmstat`.<br><br>**Lab 3.7**: Phân tích I/O.<br>1. **Tình huống**: Script `/tmp/stress_io.sh` tạo tải I/O (input: hệ thống Linux; output: I/O tăng).<br>2. Chạy `iostat` để kiểm tra I/O disk (output: thống kê I/O).<br>3. Xác định thiết bị disk bị tải (output: device name).<br>4. Dừng script và kiểm tra lại.<br>5. Ghi kết quả vào /tmp/iostat_report.txt.<br>**Script mẫu**: `#!/bin/bash\ndd if=/dev/zero of=/tmp/testfile bs=1M count=1000`.<br><br>**Lab 3.8**: Tích hợp giám sát.<br>1. Chạy service apache2/httpd (input: hệ thống Linux; output: service chạy).<br>2. Giám sát tài nguyên bằng `top` (output: thông tin process).<br>3. Ghi log service vào /var/log/httpd.log.<br>4. Kiểm tra CPU usage của apache2 (output: CPU usage hiển thị).<br>5. Ghi kết quả vào /tmp/apache_metrics.txt.<br><br>**Lab 3.9**: Phân tích load average.<br>1. **Tình huống**: Script `/tmp/stress_cpu.sh` tạo tải CPU (input: hệ thống Linux; output: load average tăng).<br>2. Chạy `uptime` để xem load average (output: giá trị load).<br>3. So sánh với `top` (output: xác định process gây tải).<br>4. Dừng script và kiểm tra lại.<br>5. Ghi kết quả vào /tmp/load_report.txt.<br><br>**Lab 3.10**: Giám sát disk.<br>1. Chạy `df -h` để xem disk usage (input: hệ thống Linux; output: thông tin disk).<br>2. Tạo file lớn bằng `/tmp/stress_io.sh` (output: disk usage tăng).<br>3. Kiểm tra disk bằng `du` (output: dung lượng file).<br>4. Xóa file và kiểm tra lại.<br>5. Ghi kết quả vào /tmp/disk_report.txt. |

**Ghi chú**:
- Script mẫu:
  - `/tmp/stress_io.sh`: `#!/bin/bash\ndd if=/dev/zero of=/tmp/testfile bs=1M count=1000`
  - `/tmp/stress_cpu.sh`: `#!/bin/bash\nstress --cpu 2 --timeout 60`
- Chạy script: `chmod +x /tmp/*.sh` và `./tmp/stress_io.sh` hoặc `./tmp/stress_cpu.sh`.

## Ngày 4: Bảo mật và Tự động hóa

| **Chủ đề** | **Bài học** | **Tài liệu tham khảo** | **Bài tập thực hành** |
|------------|-------------|-----------------------|-----------------------|
| **Bảo mật Linux cơ bản** | <ul><li>Hiểu firewalld: quản lý rule, port.</li><li>Quản lý permission: chmod, chown.</li><li>Giới thiệu SELinux: mode, context cơ bản.</li><li>**Yêu cầu cần đạt**: Biết cấu hình firewall rule, gán quyền file, kiểm tra trạng thái SELinux.</li></ul> | - [Red Hat: Securing Linux](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening)<br>- [Ubuntu: Security](https://ubuntu.com/server/docs/security)<br>- [Linux Foundation: Security Basics](https://training.linuxfoundation.org)<br>- Sách: "Linux Administration Handbook" (Chương 12)<br>- Sách: "Practical Linux System Administration" (Chương 12)<br>- Khóa học: [Linux Academy: Linux Security](https://linuxacademy.com)<br>- Khóa học: [Pluralsight: Linux Security](https://pluralsight.com) | **Lab 4.1**: Cấu hình firewalld.<br>1. Kích hoạt firewalld (input: hệ thống Linux; output: firewalld chạy).<br>2. Thêm rule cho phép port 80 (output: port 80 mở).<br>3. Kiểm tra rule bằng lệnh firewall (output: danh sách rule).<br>4. Thử truy cập port 80 bằng `curl` (output: truy cập thành công).<br>5. Ghi danh sách rule vào /tmp/firewall_rules.txt.<br><br>**Lab 4.2**: Quản lý permission.<br>1. Tạo file /tmp/secure.txt (input: hệ thống Linux; output: file tồn tại).<br>2. Gán quyền chỉ user “testuser” đọc/ghi (output: quyền đúng, kiểm tra bằng `ls -l`).<br>3. Thử truy cập bằng user khác (output: bị từ chối).<br>4. Thay đổi quyền sang group-only (output: group truy cập được).<br>5. Ghi quyền vào /tmp/permissions.txt.<br><br>**Lab 4.3**: Giới thiệu SELinux.<br>1. Kiểm tra trạng thái SELinux (input: hệ thống Linux; output: trạng thái SELinux).<br>2. Thay đổi mode sang permissive (output: mode thay đổi).<br>3. Kiểm tra log SELinux bằng `journalctl` (output: log liên quan).<br>4. Khôi phục mode enforcing.<br>5. Ghi trạng thái SELinux vào /tmp/selinux_status.txt.<br><br>**Lab 4.4**: Bảo vệ thư mục.<br>1. Tạo thư mục /tmp/secure_dir (input: hệ thống Linux; output: thư mục tồn tại).<br>2. Gán quyền chỉ “testuser” truy cập (output: quyền đúng).<br>3. Thử truy cập bằng user khác (output: bị từ chối).<br>4. Tạo file trong thư mục (output: file tồn tại).<br>5. Ghi quyền thư mục vào /tmp/dir_permissions.txt.<br><br>**Lab 4.5**: Kiểm tra firewall.<br>1. Thêm rule chặn port 22 (input: hệ thống Linux; output: port 22 bị chặn).<br>2. Thử truy cập ssh (output: bị từ chối).<br>3. Xóa rule và kiểm tra lại (output: ssh hoạt động).<br>4. Ghi danh sách rule vào /tmp/firewall_check.txt.<br>5. Kiểm tra trạng thái firewalld. |
| **Tự động hóa với Bash và Cron** | <ul><li>Viết script bash để tự động hóa: giám sát disk, backup.</li><li>Cấu hình cron job để chạy định kỳ.</li><li>Ứng dụng trong vận hành: tự động hóa tác vụ lặp lại.</li><li>**Yêu cầu cần đạt**: Biết viết script bash cơ bản, thiết lập cron job, kiểm tra kết quả tự động hóa.</li></ul> | - [Linux Foundation: Bash Scripting](https://training.linuxfoundation.org/resources)<br>- [Ubuntu: Cron](https://ubuntu.com/server/docs/cron)<br>- [Red Hat: Automating Tasks](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/managing_systems_using_the_rhel_8_web_console)<br>- Sách: "Practical Linux System Administration" (Chương 11)<br>- Sách: "Linux Administration Handbook" (Chương 11)<br>- Khóa học: [Pluralsight: Bash Scripting](https://pluralsight.com)<br>- Khóa học: [Linux Academy: Bash Automation](https://linuxacademy.com) | **Lab 4.6**: Viết script bash.<br>1. Viết script kiểm tra disk usage (input: hệ thống Linux; output: thông báo nếu disk đầy >80%).<br>2. Chạy script và kiểm tra output.<br>3. Lưu output vào /var/log/disk.log.<br>4. Kiểm tra dung lượng log file.<br>5. Ghi script vào /tmp/disk_script.txt.<br>**Script mẫu**: `#!/bin/bash\nTHRESHOLD=80\nUSAGE=$(df -h / | grep -v Filesystem | awk '{print $5}' | cut -d'%' -f1)\nif [ $USAGE -gt $THRESHOLD ]; then echo "Disk usage high: $USAGE%" >> /var/log/disk.log; fi`.<br><br>**Lab 4.7**: Tự động hóa với cron.<br>1. Tạo cron job chạy script disk usage mỗi 5 phút (input: script; output: cron job thiết lập).<br>2. Kiểm tra log cron (output: log xác nhận job chạy).<br>3. Thay đổi thời gian chạy sang mỗi 10 phút.<br>4. Kiểm tra lại log cron.<br>5. Ghi cấu hình cron vào /tmp/cron_config.txt.<br><br>**Lab 4.8**: Backup tự động.<br>1. Viết script backup /etc (input: hệ thống Linux; output: file backup trong /tmp).<br>2. Tạo cron job chạy backup hàng ngày (output: backup chạy định kỳ).<br>3. Kiểm tra file backup bằng `ls`.<br>4. Kiểm tra dung lượng file backup.<br>5. Ghi script backup vào /tmp/backup_script.txt.<br>**Script mẫu**: `#!/bin/bash\ntar -czf /tmp/etc_backup_$(date +%F).tar.gz /etc`.<br><br>**Lab 4.9**: Giám sát service.<br>1. Viết script kiểm tra trạng thái apache2/httpd (input: hệ thống Linux; output: thông báo nếu service dừng).<br>2. Chạy script và kiểm tra output.<br>3. Tạo cron job chạy script mỗi 5 phút.<br>4. Kiểm tra log cron (output: log xác nhận).<br>5. Ghi script vào /tmp/service_script.txt.<br>**Script mẫu**: `#!/bin/bash\nif ! systemctl is-active apache2; then echo "Apache stopped" >> /var/log/service.log; fi`.<br><br>**Lab 4.10**: Tự động hóa log.<br>1. Viết script đếm số dòng trong /var/log/syslog (input: file log; output: số dòng).<br>2. Tạo cron job chạy script mỗi giờ.<br>3. Lưu output vào /var/log/log_count.txt.<br>4. Kiểm tra log cron (output: log xác nhận).<br>5. Ghi script vào /tmp/logcount_script.txt.<br>**Script mẫu**: `#!/bin/bash\nwc -l /var/log/syslog >> /var/log/log_count.txt`. |

**Ghi chú**:
- Script mẫu:
  - `/tmp/disk_script.sh`: `#!/bin/bash\nTHRESHOLD=80\nUSAGE=$(df -h / | grep -v Filesystem | awk '{print $5}' | cut -d'%' -f1)\nif [ $USAGE -gt $THRESHOLD ]; then echo "Disk usage high: $USAGE%" >> /var/log/disk.log; fi`
  - `/tmp/backup_script.sh`: `#!/bin/bash\ntar -czf /tmp/etc_backup_$(date +%F).tar.gz /etc`
  - `/tmp/service_script.sh`: `#!/bin/bash\nif ! systemctl is-active apache2; then echo "Apache stopped" >> /var/log/service.log; fi`
  - `/tmp/logcount_script.sh`: `#!/bin/bash\nwc -l /var/log/syslog >> /var/log/log_count.txt`
- Chạy script: `chmod +x /tmp/*.sh`.

## Ngày 5: Xử lý sự cố và Final Lab

| **Chủ đề** | **Bài học** | **Tài liệu tham khảo** | **Bài tập thực hành** |
|------------|-------------|-----------------------|-----------------------|
| **Xử lý sự cố Linux** | <ul><li>Phân tích sự cố: disk đầy, service crash, lỗi permission.</li><li>Sử dụng log (journalctl) và công cụ giám sát (top, iostat).</li><li>Quy trình troubleshoot: xác định vấn đề, phân tích, khắc phục.</li><li>**Yêu cầu cần đạt**: Biết phân tích log, xác định nguyên nhân sự cố, khắc phục vấn đề cơ bản.</li></ul> | - [Red Hat: Troubleshooting](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/troubleshooting)<br>- [Ubuntu: Troubleshooting](https://ubuntu.com/server/docs/troubleshooting)<br>- [Linux Foundation: Troubleshooting Basics](https://training.linuxfoundation.org)<br>- Sách: "Linux Administration Handbook" (Chương 14)<br>- Sách: "Practical Linux System Administration" (Chương 14)<br>- Khóa học: [Linux Academy: Linux Troubleshooting](https://linuxacademy.com)<br>- Khóa học: [Pluralsight: Linux Troubleshooting](https://pluralsight.com) | **Lab 5.1**: Xử lý disk đầy.<br>1. **Tình huống**: Script `/tmp/fill_disk.sh` làm đầy disk (input: hệ thống Linux; output: disk usage >90%).<br>2. Phân tích disk usage bằng `df -h` (output: xác định disk đầy).<br>3. Tìm file lớn bằng `du` (output: file gây đầy).<br>4. Xóa file và kiểm tra lại disk.<br>5. Ghi nguyên nhân vào /tmp/disk_issue.txt.<br>**Script mẫu**: `#!/bin/bash\ndd if=/dev/zero of=/tmp/bigfile bs=1M count=15000`.<br><br>**Lab 5.2**: Khắc phục service crash.<br>1. **Tình huống**: Script `/tmp/stop_apache.sh` tắt apache2 (input: hệ thống Linux; output: service không chạy).<br>2. Phân tích log bằng `journalctl` (output: xác định nguyên nhân).<br>3. Khởi động lại service (output: service chạy).<br>4. Kiểm tra trạng thái service.<br>5. Ghi nguyên nhân vào /tmp/service_issue.txt.<br>**Script mẫu**: `#!/bin/bash\nsystemctl stop apache2`.<br><br>**Lab 5.3**: Xử lý lỗi permission.<br>1. **Tình huống**: Script `/tmp/wrong_perm.sh` sai quyền file Apache (input: hệ thống Linux; output: service lỗi).<br>2. Phân tích log và quyền file bằng `ls -l` (output: xác định lỗi permission).<br>3. Sửa quyền và kiểm tra lại service.<br>4. Thử truy cập bằng `curl localhost` (output: truy cập thành công).<br>5. Ghi nguyên nhân vào /tmp/permission_issue.txt.<br>**Script mẫu**: `#!/bin/bash\nchmod 000 /var/www/html/index.html`.<br><br>**Lab 5.4**: Xử lý log đầy.<br>1. **Tình huống**: Script `/tmp/fill_log.sh` tạo log lớn (input: hệ thống Linux; output: /var/log/syslog lớn).<br>2. Kiểm tra dung lượng log bằng `du` (output: dung lượng log).<br>3. Xóa hoặc nén log (output: dung lượng giảm).<br>4. Kiểm tra logrotate hoạt động.<br>5. Ghi nguyên nhân vào /tmp/log_issue.txt.<br>**Script mẫu**: `#!/bin/bash\nfor i in {1..1000}; do logger "Test log $i"; done`.<br><br>**Lab 5.5**: Xử lý CPU cao.<br>1. **Tình huống**: Script `/tmp/stress_cpu.sh` tạo tải CPU (input: hệ thống Linux; output: CPU usage >80%).<br>2. Xác định process gây tải bằng `top` (output: PID process).<br>3. Dừng process (output: CPU usage giảm).<br>4. Kiểm tra lại bằng `uptime`.<br>5. Ghi nguyên nhân vào /tmp/cpu_issue.txt.<br>**Script mẫu**: `#!/bin/bash\nstress --cpu 2 --timeout 60`. |
| **Final Lab: Hệ thống Linux hoàn chỉnh** | <ul><li>Tích hợp kiến thức: user, service, logging, monitoring, troubleshooting.</li><li>Thiết lập hệ thống end-to-end với Apache, log, và cron job.</li><li>Xử lý sự cố giả lập: disk đầy, service crash.</li><li>**Yêu cầu cần đạt**: Biết thiết lập hệ thống cơ bản, giám sát, khắc phục sự cố, báo cáo trạng thái.</li></ul> | - [Red Hat: System Administration](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/system_administration)<br>- [Ubuntu: Server Guide](https://ubuntu.com/server/docs)<br>- [Linux Foundation: System Administration](https://training.linuxfoundation.org)<br>- Sách: "Practical Linux System Administration" (Chương 15)<br>- Sách: "Linux Administration Handbook" (Chương 15)<br>- Khóa học: [Pluralsight: Linux System Administration](https://pluralsight.com)<br>- Khóa học: [Linux Academy: Linux Administration](https://linuxacademy.com) | **Final Lab**: Thiết lập hệ thống Linux hoàn chỉnh.<br>**Mục tiêu**: Thiết lập hệ thống Linux với Apache, user, logging, monitoring, và xử lý sự cố.<br>**Input**: Máy ảo Ubuntu/CentOS (2 CPU, 4GB RAM, 20GB disk).<br>**Output**: Hệ thống chạy ổn định, log được ghi, monitoring hoạt động, sự cố khắc phục.<br>**Guideline**:<br>1. Tạo user “webadmin” và group “webgroup”, gán quyền cho /var/www/html.<br>2. Cài đặt và chạy Apache (port 80, truy cập được localhost).<br>3. Cấu hình rsyslog để ghi log Apache vào /var/log/httpd.log.<br>4. Tạo cron job kiểm tra disk usage mỗi 5 phút, lưu vào /var/log/disk.log.<br>5. **Tình huống**: Script `/tmp/simulate_issue.sh` gây disk đầy hoặc Apache crash (output: hệ thống lỗi).<br>6. Phân tích log bằng `journalctl` và `df -h` (output: xác định nguyên nhân).<br>7. Khắc phục sự cố (output: hệ thống hoạt động lại).<br>8. Báo cáo trạng thái: user, service, log, metrics trong /tmp/final_report.txt.<br>**Script mẫu**: `#!/bin/bash\ndd if=/dev/zero of=/tmp/bigfile bs=1M count=15000; systemctl stop apache2`. |

**Ghi chú**:
- Script mẫu:
  - `/tmp/simulate_issue.sh`: `#!/bin/bash\ndd if=/dev/zero of=/tmp/bigfile bs=1M count=15000; systemctl stop apache2`
  - `/tmp/fill_disk.sh`: `#!/bin/bash\ndd if=/dev/zero of=/tmp/bigfile bs=1M count=15000`
  - `/tmp/stop_apache.sh`: `#!/bin/bash\nsystemctl stop apache2`
  - `/tmp/wrong_perm.sh`: `#!/bin/bash\nchmod 000 /var/www/html/index.html`
  - `/tmp/fill_log.sh`: `#!/bin/bash\nfor i in {1..1000}; do logger "Test log $i"; done`
  - `/tmp/stress_cpu.sh`: `#!/bin/bash\nstress --cpu 2 --timeout 60`
- Chạy script: `chmod +x /tmp/*.sh`.