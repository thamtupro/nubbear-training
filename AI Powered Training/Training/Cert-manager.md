# Lịch trình đào tạo Cert-Manager trong 5 ngày

## Ngày 1: Giới thiệu về Cert-Manager và TLS/SSL trong Kubernetes

| **Chủ đề** | **Bài học** | **Tài liệu tham khảo** | **Bài tập thực hành** |
|------------|-------------|-----------------------|-----------------------|
| **Tổng quan về Cert-Manager** | Hiểu vai trò của Cert-Manager trong Kubernetes: tự động hóa cấp phát, gia hạn, và quản lý chứng chỉ TLS/SSL. So sánh với các giải pháp thủ công (openssl) hoặc khác (AWS ACM). Yêu cầu: giải thích được khái niệm chứng chỉ, CA, và ứng dụng trong HTTPS. | - [Cert-Manager Concepts](https://cert-manager.io/docs/concepts/)<br>- [TLS/SSL Basics](https://www.cloudflare.com/learning/ssl/what-is-ssl/)<br>- [Why Use Cert-Manager](https://cert-manager.io/docs/faq/) | **Lab 1.1**: Thiết lập môi trường thực hành.<br>1. Chuẩn bị Kubernetes cluster (sử dụng minikube hoặc kind trên máy local).<br>2. Kiểm tra trạng thái cluster với `kubectl get nodes`.<br>3. Tạo namespace `cert-manager` cho các bài lab sau.<br><br>**Lab 1.2**: Cài đặt Cert-Manager.<br>1. Cài đặt Cert-Manager bằng Helm hoặc manifest YAML.<br>2. Kiểm tra trạng thái pod trong namespace `cert-manager`.<br>3. Xác minh webhook của Cert-Manager hoạt động.<br><br>**Lab 1.3**: Khám phá TLS/SSL.<br>1. Tạo một chứng chỉ tự ký bằng `openssl` trên máy local.<br>2. Xem nội dung chứng chỉ với `openssl x509`.<br>3. Ghi chú sự khác biệt giữa chứng chỉ tự ký và CA-signed. |
| **Kiến trúc Cert-Manager** | Hiểu các thành phần chính: Certificate, Issuer, ClusterIssuer, CRDs (Custom Resource Definitions). Yêu cầu: vẽ sơ đồ luồng cấp phát chứng chỉ từ Issuer đến Ingress. | - [Cert-Manager Architecture](https://cert-manager.io/docs/concepts/issuer/)<br>- [CRDs in Kubernetes](https://kubernetes.io/docs/concepts/extend-kubernetes/api-extension/custom-resources/) | **Lab 1.4**: Khám phá CRDs.<br>1. Liệt kê các CRDs của Cert-Manager bằng `kubectl get crds`.<br>2. Xem cấu hình một Issuer mẫu qua `kubectl describe`.<br>3. Tạo một Issuer tự ký đơn giản và kiểm tra trạng thái.<br><br>**Lab 1.5**: Vẽ sơ đồ kiến trúc.<br>1. Vẽ sơ đồ luồng từ Certificate → Issuer → CA.<br>2. Ghi chú vai trò của ClusterIssuer so với Issuer.<br>3. Thảo luận sự khác biệt trong ứng dụng thực tế. |

**Tổng thời gian**: 6 giờ  
**Ghi chú**: Đảm bảo bạn có Kubernetes cluster (minikube hoặc kind) và Helm cài đặt sẵn. Sử dụng máy local hoặc cloud miễn phí (như AWS Free Tier) để thực hành.

## Ngày 2: Cài đặt và cấu hình Issuer

| **Chủ đề** | **Bài học** | **Tài liệu tham khảo** | **Bài tập thực hành** |
|------------|-------------|-----------------------|-----------------------|
| **Cấu hình Issuer và ClusterIssuer** | Hiểu cách thiết lập Issuer (namespace-scoped) và ClusterIssuer (cluster-wide) để cấp chứng chỉ từ CA như Let's Encrypt, self-signed, hoặc Vault. Yêu cầu: phân biệt được các loại Issuer và khi nào sử dụng. | - [Issuer Configuration](https://cert-manager.io/docs/configuration/)<br>- [Let's Encrypt with Cert-Manager](https://cert-manager.io/docs/configuration/acme/) | **Lab 2.1**: Tạo self-signed Issuer.<br>1. Tạo một self-signed Issuer trong namespace `cert-manager`.<br>2. Kiểm tra trạng thái Issuer với `kubectl describe`.<br>3. Ghi chú các thông số quan trọng trong cấu hình YAML.<br><br>**Lab 2.2**: Tạo Let's Encrypt Issuer.<br>1. Tạo ClusterIssuer dùng Let's Encrypt staging environment.<br>2. Cấu hình ACME challenge (HTTP01 hoặc DNS01) với email của bạn.<br>3. Kiểm tra trạng thái ClusterIssuer.<br><br>**Lab 2.3**: So sánh Issuer.<br>1. Tạo một Certificate dùng self-signed Issuer.<br>2. Tạo một Certificate dùng Let's Encrypt ClusterIssuer.<br>3. Ghi chú sự khác biệt về thời gian cấp phát và thông tin chứng chỉ. |
| **Quản lý Certificate** | Hiểu cách định nghĩa Certificate resource: cấu hình DNS names, secret storage, và renew policy. Yêu cầu: giải thích được lifecycle của Certificate (pending, issued, failed). | - [Certificate Resource](https://cert-manager.io/docs/usage/certificate/)<br>- [Certificate Lifecycle](https://cert-manager.io/docs/concepts/certificate/) | **Lab 2.4**: Tạo Certificate resource.<br>1. Tạo một Certificate cho domain giả lập (ví dụ: `example.local`).<br>2. Kiểm tra Secret chứa chứng chỉ trong namespace.<br>3. Xem trạng thái Certificate với `kubectl describe`.<br><br>**Lab 2.5**: Kiểm tra lifecycle.<br>1. Tạo Certificate với DNS name không hợp lệ.<br>2. Quan sát trạng thái `failed` qua `kubectl describe`.<br>3. Sửa DNS name và kiểm tra trạng thái `issued`. |

**Tổng thời gian**: 6 giờ  
**Ghi chú**: Sử dụng Let's Encrypt staging để tránh giới hạn rate limit. Đảm bảo bạn có quyền truy cập domain hoặc DNS server giả lập.

## Ngày 3: Tích hợp Cert-Manager với Ingress

| **Chủ đề** | **Bài học** | **Tài liệu tham khảo** | **Bài tập thực hành** |
|------------|-------------|-----------------------|-----------------------|
| **Tích hợp với Ingress** | Hiểu cách Cert-Manager tích hợp với Ingress controller (như Nginx) để tự động cấp chứng chỉ cho HTTPS. Yêu cầu: giải thích được annotation của Cert-Manager trong Ingress. | - [Ingress with Cert-Manager](https://cert-manager.io/docs/usage/ingress/)<br>- [Nginx Ingress Controller](https://kubernetes.github.io/ingress-nginx/) | **Lab 3.1**: Cài đặt Nginx Ingress.<br>1. Cài đặt Nginx Ingress Controller vào cluster.<br>2. Kiểm tra trạng thái pod của Ingress Controller.<br>3. Tạo một Ingress đơn giản để kiểm tra kết nối HTTP.<br><br>**Lab 3.2**: Tích hợp Cert-Manager với Ingress.<br>1. Tạo một Ingress với annotation của Cert-Manager để cấp chứng chỉ.<br>2. Kiểm tra Secret chứa chứng chỉ được tạo tự động.<br>3. Truy cập domain qua HTTPS để xác minh.<br><br>**Lab 3.3**: Xử lý lỗi Ingress.<br>1. Tạo Ingress với cấu hình sai (ví dụ: sai Issuer).<br>2. Quan sát lỗi qua `kubectl describe ingress`.<br>3. Sửa cấu hình và kiểm tra lại kết nối HTTPS. |
| **ACME Challenges** | Hiểu HTTP01 và DNS01 challenge để xác minh quyền sở hữu domain. Yêu cầu: phân biệt được ưu/nhược điểm của từng loại challenge. | - [ACME Challenges](https://cert-manager.io/docs/configuration/acme/)<br>- [DNS01 vs HTTP01](https://letsencrypt.org/docs/challenge-types/) | **Lab 3.4**: Thực hiện HTTP01 challenge.<br>1. Cấu hình Ingress để dùng HTTP01 challenge với Let's Encrypt.<br>2. Kiểm tra pod ACME solver được tạo tự động.<br>3. Xác minh chứng chỉ được cấp qua Secret.<br><br>**Lab 3.5**: Thử DNS01 challenge.<br>1. Cấu hình ClusterIssuer với DNS01 challenge (dùng DNS provider giả lập như Cloudflare).<br>2. Tạo Certificate với DNS01.<br>3. Ghi chú sự khác biệt về thời gian và độ phức tạp so với HTTP01. |

**Tổng thời gian**: 6 giờ  
**Ghi chú**: Đảm bảo bạn đã cài Nginx Ingress Controller và có domain giả lập hoặc thực để thực hành.

## Ngày 4: Giám sát và quản trị Cert-Manager

| **Chủ đề** | **Bài học** | **Tài liệu tham khảo** | **Bài tập thực hành** |
|------------|-------------|-----------------------|-----------------------|
| **Giám sát Cert-Manager** | Hiểu cách giám sát trạng thái Cert-Manager: metrics (Prometheus), logs, và events. Yêu cầu: giải thích được cách tích hợp Cert-Manager metrics với Prometheus. | - [Cert-Manager Monitoring](https://cert-manager.io/docs/monitoring/)<br>- [Prometheus Metrics](https://prometheus.io/docs/concepts/metric-types/) | **Lab 4.1**: Thu thập metrics.<br>1. Kích hoạt Prometheus metrics endpoint cho Cert-Manager.<br>2. Tạo ServiceMonitor để scrape metrics.<br>3. Xem metrics qua Prometheus UI.<br><br>**Lab 4.2**: Tạo dashboard cơ bản.<br>1. Tạo dashboard Grafana với metrics Cert-Manager (ví dụ: số Certificate issued/failed).<br>2. Kiểm tra dashboard hiển thị dữ liệu.<br>3. Ghi chú các metric quan trọng để giám sát.<br><br>**Lab 4.3**: Kiểm tra logs.<br>1. Thu thập logs của pod Cert-Manager bằng `kubectl logs`.<br>2. Tìm lỗi liên quan đến Certificate hoặc Issuer.<br>3. Ghi chú cách xử lý một lỗi mẫu (ví dụ: Issuer không sẵn sàng). |
| **Quản trị nâng cao** | Hiểu cách quản lý renew, revoke, và backup chứng chỉ. Yêu cầu: giải thích được quy trình renew tự động và xử lý lỗi khi renew thất bại. | - [Certificate Renewal](https://cert-manager.io/docs/concepts/certificate/#renewal)<br>- [Backup with Velero](https://velero.io/docs/) | **Lab 4.4**: Kiểm tra renew tự động.<br>1. Tạo Certificate với thời gian sống ngắn (1 giờ).<br>2. Quan sát quy trình renew qua `kubectl describe`.<br>3. Ghi chú thời gian renew và Secret được cập nhật.<br><br>**Lab 4.5**: Backup Cert-Manager.<br>1. Cài đặt Velero để backup namespace `cert-manager`.<br>2. Thực hiện backup và kiểm tra dữ liệu.<br>3. Khôi phục namespace từ backup và xác minh trạng thái. |

**Tổng thời gian**: 6 giờ  
**Ghi chú**: Cần cài Prometheus và Grafana để thực hành giám sát. Velero là tùy chọn, có thể dùng snapshot thủ công nếu không có Velero.

## Ngày 5: Final Lab và đánh giá

| **Chủ đề** | **Bài học** | **Tài liệu tham khảo** | **Bài tập thực hành** |
|------------|-------------|-----------------------|-----------------------|
| **Final Lab: Triển khai ứng dụng với HTTPS** | Triển khai ứng dụng 3 thành phần (Frontend, Backend, Database) với Ingress và chứng chỉ HTTPS tự động từ Cert-Manager. Yêu cầu: hiểu toàn bộ workflow từ cấu hình Issuer đến kiểm tra HTTPS. | - [Cert-Manager Tutorial](https://cert-manager.io/docs/tutorials/)<br>- [Kubernetes Ingress](https://kubernetes.io/docs/concepts/services-networking/ingress/) | **Final Lab**: Triển khai ứng dụng hoàn chỉnh.<br>**Mục tiêu**: Triển khai ứng dụng web (Frontend: Nginx, Backend: Node.js, Database: MySQL) với Ingress và HTTPS qua Cert-Manager.<br>**Input**:<br>- Kubernetes cluster với Nginx Ingress Controller.<br>- Let's Encrypt ClusterIssuer đã cấu hình.<br>- Helm chart hoặc manifest YAML cho ứng dụng.<br>**Output**:<br>- Ứng dụng web truy cập được qua HTTPS (domain giả lập hoặc thực).<br>- Chứng chỉ được cấp tự động và renew đúng hạn.<br>- Metrics Cert-Manager được giám sát qua Prometheus/Grafana.<br>**Outline và Guideline**:<br>1. Tạo namespace `app-demo` cho ứng dụng.<br>2. Triển khai MySQL pod với PersistentVolume.<br>3. Triển khai Backend (Node.js) với Service.<br>4. Triển khai Frontend (Nginx) với Ingress.<br>5. Cấu hình Ingress annotation để dùng Let's Encrypt ClusterIssuer.<br>6. Tạo ServiceMonitor để thu thập metrics Cert-Manager.<br>7. Kiểm tra kết nối HTTPS qua trình duyệt hoặc `curl`.<br>8. Quan sát dashboard Grafana để xác minh metrics.<br>**Lưu ý**: Không cung cấp cách làm chi tiết, chỉ dùng `kubectl`, `helm`, hoặc `curl` khi cần thiết (ví dụ: `kubectl apply -f` để áp dụng manifest). |
| **Đánh giá kiến thức** | Củng cố kiến thức qua câu hỏi trắc nghiệm (MCQ) và vấn đáp. Yêu cầu: trả lời được ít nhất 80% câu hỏi đúng. | - [Cert-Manager FAQ](https://cert-manager.io/docs/faq/)<br>- [Kubernetes Networking](https://kubernetes.io/docs/concepts/services-networking/) | **Lab 5.1**: Trắc nghiệm (MCQ).<br>1. Tạo 10 câu hỏi MCQ về Cert-Manager (ví dụ: Vai trò của ClusterIssuer? HTTP01 vs DNS01?).<br>2. Tự trả lời và kiểm tra đáp án qua tài liệu.<br>3. Ghi chú các câu trả lời sai để ôn lại.<br><br>**Lab 5.2**: Vấn đáp.<br>1. Chuẩn bị 5 câu hỏi vấn đáp (ví dụ: Làm thế nào để debug khi Certificate không được cấp?).<br>2. Trả lời và ghi lại câu trả lời.<br>3. Đối chiếu với tài liệu để cải thiện.<br><br>**Lab 5.3**: Phân tích Final Lab.<br>1. Ghi lại các bước thực hiện Final Lab.<br>2. Ghi chú các lỗi gặp phải và cách xử lý.<br>3. Đề xuất cải tiến cho workflow (ví dụ: thêm automation cho backup). |

**Tổng thời gian**: 6 giờ  
**Ghi chú**: Final Lab yêu cầu tích hợp tất cả kỹ năng từ Ngày 1-4. Chuẩn bị domain giả lập hoặc thực để kiểm tra HTTPS.
